import os
import bait.util.testing

const ROOT_DIRS := [
	'hello_world',
	// 'loops'
]

const DIRS := [
	'100_doors',
]

const C_SKIPS := [
	'100_doors',
]

fun test_task_inout() {
	tasks := os.dir($FILE)

	runner := testing.InOutRunner{
		check_stdout = true
	}

	// JS backend (default)
	for rd in ROOT_DIRS {
		runner.root = os.join_path(tasks, [rd])
		runner.test_all_in_root()
	}
	runner.root = tasks
	for d in DIRS {
		runner.test_dir(d)
	}

	// C backend
	runner.cmd_options = '-b c'
	runner.skips = C_SKIPS

	for rd in ROOT_DIRS {
		runner.root = os.join_path(tasks, [rd])
		runner.test_all_in_root()
	}
	runner.root = tasks
	for d in DIRS {
		runner.test_dir(d)
	}
}
